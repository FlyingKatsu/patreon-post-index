<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Patreon Indexer | FlyingKatsu</title>
  <meta name="description" content="Simple indexing of a patreon campaign's posts">
  <meta name="author" content="FlyingKatsu">
  <!-- credit: Remarkable https://github.com/jonschlinkert/remarkable -->
  <script src="https://cdn.jsdelivr.net/remarkable/1.7.1/remarkable.min.js"></script>
  <!-- Main Script -->
  <script src="patreon.js"></script>
  <!-- credit: github-markdown-css https://sindresorhus.com/github-markdown-css/-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css" type="text/css" media="screen" />
  <style>
    .markdown-body {
        min-width: 200px;
        max-width: 980px;
        margin: 0 auto;
        padding: 4em;
    }
    .raw {
        max-height: 8em;
        overflow: auto;
        font-family: 'Courier New', Courier, monospace;
        background-color: #eeeeff;
        border-radius: 1em;
        padding: 0.5em;
    }
    @media (max-width: 767px) {
        .markdown-body {
            padding: 2em;
        }
    }
  </style>
</head>

<body class="markdown-body">
  <header id="info"></header>

  <label for="filenames">Filenames relative to this HTML file (comma-separated): </label>
  <input id="filenames" name="filenames" type="text" value="data/1.json, data/2.json">
  <button onclick="readFiles('filenames','output-formatted','output-raw')">Get posts!</button>
  <p>Alternatively, see <a href="demo.html">demo.html</a> to query from five other pre-collected data sets.</p>

  <div>
      <h2>Raw Markdown Output</h2>
      <div id="output-raw" class="raw"></div>
  </div>
  <div>
      <h2>Formatted Markdown</h2>
      <div id="output-formatted"></div>
  </div>
  
  <script>
    let info = `# Patreon Post Index Generator`;
    info += `\nThis is an example of formatting post data requested from Patreon, using the ID of [HeatPhoenix](https://www.patreon.com/join/heatphoenix)'s Patreon campaign.`;
    info += `\n\nIf you want to use this for another campaign,\n1. [download the files](https://github.com/FlyingKatsu/patreon-post-index), \n2. access the following URL (replacing ${'`'}CAMPAIGN-ID${'`'} as appropriate) to get the first 20 posts, \n3. save the file as ${'`'}1.json${'`'} and if there is a link at the bottom of the data, use it to get the next 20 posts\n4. replace the ${'`'}data/#.json${'`'} files with the data you receive:`;
    info += `\n\n${'```'}https://www.patreon.com/api/posts?filter[campaign_id]=CAMPAIGN-ID&include=attachments,user_defined_tags,campaign.rewards&fields[post]=content,min_cents_pledged_to_view,post_type,title,url,published_at&sort=-published_at&filter[is_draft]=false${'```'}`;
    info += `\n\n**Please Note:** Data will only include attachment filenames if you are at the appropriate pledge tier. For example, this dataset only includes attachments up to the $1 tier. If you are not a patron, or not signed in, you will only see attachments for the "Everyone" tier!`;
    info += `\n\n---`
    document.getElementById('info').innerHTML = md.render(info);
  </script>
</body>
</html>
